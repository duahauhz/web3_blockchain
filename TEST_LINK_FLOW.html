<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Link Sharing Flow</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-box {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        h1 {
            color: #ff6b35;
        }
        .step {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        input, button {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            font-size: 16px;
            border-radius: 8px;
            border: 2px solid #ddd;
        }
        button {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            opacity: 0.9;
        }
        .result {
            background: #e7f5ff;
            padding: 15px;
            border-left: 4px solid #228be6;
            margin: 15px 0;
            word-break: break-all;
        }
        .error {
            background: #ffe0e0;
            padding: 15px;
            border-left: 4px solid #dc3545;
            margin: 15px 0;
        }
        .success {
            background: #d4edda;
            padding: 15px;
            border-left: 4px solid #28a745;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="test-box">
        <h1>üß™ Test Link Sharing Flow</h1>
        <p>Test xem flow t·∫°o link v√† chia s·∫ª c√≥ ho·∫°t ƒë·ªông kh√¥ng</p>

        <div class="step">
            <h3>B∆∞·ªõc 1: Simulate t·∫°o L√¨ X√¨ th√†nh c√¥ng</h3>
            <p>Gi·∫£ l·∫≠p ID sau khi t·∫°o l√¨ x√¨:</p>
            <input type="text" id="lixiId" value="0xabc123def456789" placeholder="Nh·∫≠p Lixi ID">
            <button onclick="generateLink()">üîó T·∫°o Link Chia S·∫ª</button>
        </div>

        <div id="linkResult" style="display:none;" class="result">
            <h4>‚úÖ Link ƒë√£ t·∫°o:</h4>
            <p id="generatedLink" style="font-family: monospace;"></p>
            <button onclick="copyLink()">üìã Copy Link</button>
            <button onclick="openLink()">üåê M·ªü Link (Tab M·ªõi)</button>
        </div>

        <div class="step">
            <h3>B∆∞·ªõc 2: Test Parse URL Query</h3>
            <p>Test xem URL c√≥ parse ƒë√∫ng query parameter kh√¥ng:</p>
            <input type="text" id="testUrl" value="http://localhost:5173/claim-lixi?id=0xabc123" placeholder="Nh·∫≠p URL ƒë·ªÉ test">
            <button onclick="parseUrl()">üîç Parse URL</button>
        </div>

        <div id="parseResult" style="display:none;"></div>

        <div class="step">
            <h3>B∆∞·ªõc 3: Test trong App Th·ª±c</h3>
            <ol>
                <li>M·ªü <a href="http://localhost:5173" target="_blank">http://localhost:5173</a></li>
                <li>Connect Sui Wallet</li>
                <li>Click "üßß T·∫°o L√¨ X√¨ Nh√≥m"</li>
                <li>Sau khi t·∫°o th√†nh c√¥ng, ki·ªÉm tra:
                    <ul>
                        <li>‚úÖ C√≥ hi·ªÉn th·ªã link ƒë·∫ßy ƒë·ªß kh√¥ng?</li>
                        <li>‚úÖ C√≥ n√∫t "Copy Link" kh√¥ng?</li>
                        <li>‚úÖ Click Copy c√≥ hi·ªÉn th·ªã alert kh√¥ng?</li>
                    </ul>
                </li>
                <li>Paste link v√†o tab m·ªõi</li>
                <li>Ki·ªÉm tra Lixi ID c√≥ t·ª± ƒë·ªông ƒëi·ªÅn kh√¥ng</li>
            </ol>
        </div>

        <div class="success">
            <h4>‚úÖ X√°c nh·∫≠n c√°c warnings trong Console</h4>
            <p><strong>Nh·ªØng warnings sau ƒë√¢y l√† B√åNH TH∆Ø·ªúNG, kh√¥ng ·∫£nh h∆∞·ªüng t√≠nh nƒÉng:</strong></p>
            <ul>
                <li>"Download the React DevTools" - Ch·ªâ l√† khuy·∫øn ngh·ªã c√†i extension</li>
                <li>"Could not establish connection" - L·ªói t·ª´ Chrome extension, kh√¥ng li√™n quan app</li>
                <li>"[NEW] Explain Console errors" - Qu·∫£ng c√°o t√≠nh nƒÉng Edge Copilot</li>
            </ul>
            <p><strong>N·∫øu th·∫•y l·ªói kh√°c m√†u ƒê·ªé, h√£y copy v√† g·ª≠i cho t√¥i!</strong></p>
        </div>

        <div class="error">
            <h4>‚ùå N·∫øu t√≠nh nƒÉng KH√îNG ho·∫°t ƒë·ªông, ki·ªÉm tra:</h4>
            <ol>
                <li><strong>Kh√¥ng th·∫•y n√∫t "T·∫°o L√¨ X√¨ Nh√≥m":</strong>
                    <ul>
                        <li>ƒê·∫£m b·∫£o ƒë√£ connect wallet</li>
                        <li>Refresh trang (Ctrl+R)</li>
                        <li>Check HomePage.tsx c√≥ render ƒë√∫ng kh√¥ng</li>
                    </ul>
                </li>
                <li><strong>Click n√∫t kh√¥ng c√≥ ph·∫£n ·ª©ng:</strong>
                    <ul>
                        <li>M·ªü DevTools Console (F12)</li>
                        <li>Xem c√≥ l·ªói g√¨ m√†u ƒê·ªé kh√¥ng</li>
                        <li>Check Router c√≥ ho·∫°t ƒë·ªông kh√¥ng</li>
                    </ul>
                </li>
                <li><strong>Kh√¥ng th·∫•y trang Success sau khi t·∫°o:</strong>
                    <ul>
                        <li>Transaction c√≥ th√†nh c√¥ng kh√¥ng?</li>
                        <li>Check callback onCreated c√≥ ƒë∆∞·ª£c g·ªçi kh√¥ng</li>
                        <li>Check App.tsx state currentPage</li>
                    </ul>
                </li>
                <li><strong>Link kh√¥ng c√≥ query parameter:</strong>
                    <ul>
                        <li>Check createdGiftId c√≥ null kh√¥ng</li>
                        <li>Check template string trong claimLink</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="test-box" style="background: #e3f2fd;">
            <h3>üéØ Test Checklist</h3>
            <label><input type="checkbox"> ƒê√£ connect Sui Wallet</label><br>
            <label><input type="checkbox"> Th·∫•y n√∫t "üßß T·∫°o L√¨ X√¨ Nh√≥m"</label><br>
            <label><input type="checkbox"> Click n√∫t ‚Üí Chuy·ªÉn sang form t·∫°o l√¨ x√¨</label><br>
            <label><input type="checkbox"> ƒêi·ªÅn form ‚Üí Confirm transaction th√†nh c√¥ng</label><br>
            <label><input type="checkbox"> Hi·ªÉn th·ªã trang Success v·ªõi emoji üßß</label><br>
            <label><input type="checkbox"> Hi·ªÉn th·ªã link ƒë·∫ßy ƒë·ªß c√≥ ?id=</label><br>
            <label><input type="checkbox"> Click "Copy Link" ‚Üí Alert xu·∫•t hi·ªán</label><br>
            <label><input type="checkbox"> Paste link tab m·ªõi ‚Üí ID t·ª± ƒë·ªông ƒëi·ªÅn</label><br>
            <label><input type="checkbox"> Click "T√¨m L√¨ X√¨" ‚Üí Hi·ªÉn th·ªã th√¥ng tin</label><br>
            <label><input type="checkbox"> Click "M·ªü Bao L√¨ X√¨" ‚Üí Nh·∫≠n ƒë∆∞·ª£c ti·ªÅn</label><br>
        </div>
    </div>

    <script>
        const BASE_URL = 'http://localhost:5173';

        function generateLink() {
            const lixiId = document.getElementById('lixiId').value;
            if (!lixiId) {
                alert('Vui l√≤ng nh·∫≠p Lixi ID!');
                return;
            }

            const link = `${BASE_URL}/claim-lixi?id=${lixiId}`;
            document.getElementById('generatedLink').textContent = link;
            document.getElementById('linkResult').style.display = 'block';
            
            console.log('‚úÖ Link generated:', link);
        }

        function copyLink() {
            const link = document.getElementById('generatedLink').textContent;
            navigator.clipboard.writeText(link).then(() => {
                alert('‚úÖ ƒê√£ copy link!');
            }).catch(err => {
                alert('‚ùå L·ªói copy: ' + err);
            });
        }

        function openLink() {
            const link = document.getElementById('generatedLink').textContent;
            window.open(link, '_blank');
        }

        function parseUrl() {
            const url = document.getElementById('testUrl').value;
            const resultDiv = document.getElementById('parseResult');
            
            try {
                const urlObj = new URL(url);
                const id = urlObj.searchParams.get('id');
                const pathname = urlObj.pathname;
                
                let html = '<div class="result">';
                html += '<h4>‚úÖ Parse th√†nh c√¥ng:</h4>';
                html += `<p><strong>Full URL:</strong> ${url}</p>`;
                html += `<p><strong>Protocol:</strong> ${urlObj.protocol}</p>`;
                html += `<p><strong>Host:</strong> ${urlObj.host}</p>`;
                html += `<p><strong>Pathname:</strong> ${pathname}</p>`;
                html += `<p><strong>Query:</strong> ${urlObj.search}</p>`;
                html += `<p><strong>ID Parameter:</strong> ${id || '(kh√¥ng c√≥)'}</p>`;
                
                if (id) {
                    html += '<div class="success">';
                    html += `<p>‚úÖ Query parameter 'id' t√¨m th·∫•y: <code>${id}</code></p>`;
                    html += '<p>ƒê√¢y l√† gi√° tr·ªã s·∫Ω ƒë∆∞·ª£c t·ª± ƒë·ªông ƒëi·ªÅn v√†o form!</p>';
                    html += '</div>';
                } else {
                    html += '<div class="error">';
                    html += '<p>‚ùå Kh√¥ng t√¨m th·∫•y query parameter "id"!</p>';
                    html += '<p>URL ph·∫£i c√≥ format: /claim-lixi?id=0x...</p>';
                    html += '</div>';
                }
                
                html += '</div>';
                resultDiv.innerHTML = html;
                resultDiv.style.display = 'block';
                
                console.log('Parse result:', {
                    url, pathname, query: urlObj.search, id
                });
            } catch (e) {
                resultDiv.innerHTML = `<div class="error"><h4>‚ùå L·ªói parse URL:</h4><p>${e.message}</p></div>`;
                resultDiv.style.display = 'block';
            }
        }

        // Auto test on load
        window.onload = function() {
            console.log('üß™ Test page loaded');
            console.log('Base URL:', BASE_URL);
            console.log('Current URL:', window.location.href);
            
            // Test URLSearchParams
            const testUrl = 'http://localhost:5173/claim-lixi?id=0xtest123';
            const params = new URLSearchParams(new URL(testUrl).search);
            console.log('Test parse ID:', params.get('id'));
        };
    </script>
</body>
</html>
